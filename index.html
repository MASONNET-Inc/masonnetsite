<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>MASONNET Web 3.0</title>
  <style>
    :root{
      --bg:#ff0000;
      --accent:#ffffff;
      --glass: rgba(255,255,255,0.10);
      --glass-strong: rgba(255,255,255,0.22);
      --shadow: 0 6px 18px rgba(0,0,0,0.15);
      --safe-bottom: calc(env(safe-area-inset-bottom, 0px) + 16px);
      --island-max:760px;
      --view-threshold-ms: 3600000; /* 1 hour */
    }

    /* Base */
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Arial, Helvetica, sans-serif;background:var(--bg);color:var(--accent);-webkit-font-smoothing:antialiased}
    a{color:inherit}
    img.logo{display:block;width:clamp(160px,26vw,420px);height:auto;margin:0 auto 8px;filter:drop-shadow(0 6px 18px rgba(0,0,0,0.25))}

    .page{max-width:1100px;margin:0 auto;padding:clamp(16px,3.5vw,36px);padding-bottom:calc(var(--safe-bottom) + 140px);text-align:center}

    /* Heading + hr */
    h1{margin:6px 0;font-size:clamp(20px,4.2vw,36px);font-weight:500;line-height:1.05;display:block}
    h1 u{ text-decoration:underline 2px rgba(255,255,255,0.35) }
    hr.fancy{border:0;height:1px;margin:14px auto;width:100%;max-width:900px;background:linear-gradient(90deg,rgba(255,255,255,0.06),rgba(255,255,255,0.18),rgba(255,255,255,0.06));opacity:0.95;border-radius:1px}

    /* Minimal main (intentionally empty beneath heading) */
    main{min-height:40vh}

    /* Button island (no animations) */
    .button-island{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:var(--safe-bottom);
      z-index:1100;
      display:flex;
      gap:10px;
      padding:10px;
      background:linear-gradient(180deg,var(--glass), rgba(255,255,255,0.05));
      backdrop-filter:blur(8px) saturate(1.05);
      -webkit-backdrop-filter:blur(8px) saturate(1.05);
      border-radius:999px;
      box-shadow:var(--shadow);
      width:min(calc(100% - 32px),var(--island-max));
      align-items:center;
      justify-content:space-between;
    }

    .btn{
      all:unset;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:10px 14px;
      border-radius:999px;
      background:transparent;
      color:var(--accent);
      cursor:pointer;
      min-width:48px;
      flex:0 1 auto;
    }

    .btn:active{transform:none}
    .info-btn{width:46px;height:46px;padding:0;border-radius:10px;background:rgba(255,255,255,0.04)}

    /* Icons styling */
    .icon{width:20px;height:20px;display:inline-block;vertical-align:middle;fill:currentColor;opacity:0.98}

    /* Info panel pinned to right and slightly above the button island (30px) */
    .info-panel{
      position:fixed;
      right:16px;
      bottom:calc(var(--safe-bottom) + 30px + 20px); /* 30px above island + a small offset */
      z-index:1150;
      width:clamp(200px,24vw,320px);
      max-width:92%;
      min-width:180px;
      min-height:120px;
      max-height:70vh;
      padding:12px;
      background:rgba(20,20,20,0.96);
      border-radius:10px;
      box-shadow:0 12px 32px rgba(0,0,0,0.45);
      color:#fff;
      display:none;
      flex-direction:column;
      gap:10px;
      align-items:center;
      text-align:center;
      overflow:auto;
    }

    .info-panel.visible{display:flex}
    .info-row{width:100%;display:flex;flex-direction:column;gap:6px;align-items:center}
    .version-pill{background:rgba(255,255,255,0.04);padding:6px 10px;border-radius:999px;font-weight:600;font-size:13px}
    .authors{font-size:13px;opacity:0.95}
    .contact-link{font-size:13px;text-decoration:underline;font-weight:600}

    /* view badge inside panel */
    .panel-view{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);font-weight:700;font-size:13px;min-width:100px}
    .panel-view .icon{width:16px;height:16px}

    /* Responsive tweaks */
    @media (max-width:520px){
      .button-island{gap:8px;padding:8px;width:calc(100% - 24px)}
      .btn{padding:10px}
      .info-panel{right:12px;bottom:calc(var(--safe-bottom) + 28px);width:min(86vw,300px)}
    }

    /* keep scrollbars usable on touch */
    .info-panel{-webkit-overflow-scrolling:touch}
    .info-panel::-webkit-scrollbar{width:8px;height:8px}
    .info-panel::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.06);border-radius:8px}
  </style>
</head>
<body>
  <div class="page">
    <header style="padding-top:6px">
      <img src="logo.png" alt="MASONNET logo" class="logo" />
      <h1>Welcome to MASONNET Web <u>3.0</u>!</h1>
      <hr class="fancy" />
    </header>

    <main role="main"></main>
  </div>

  <!-- Info panel (right, above island) -->
  <div class="info-panel" id="infoPanel" role="dialog" aria-hidden="true" tabindex="-1">
    <div class="info-row">
      <div class="version-pill">Version 1 - In development</div>
      <div class="authors">by Mason Murphy & MASONNET</div>
    </div>

    <div class="info-row" style="margin-top:4px">
      <div class="panel-view" id="panelView" aria-hidden="false">
        <!-- eye icon -->
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z" stroke="currentColor" stroke-width="1.2" fill="none"/>
          <circle cx="12" cy="12" r="3" fill="currentColor"/>
        </svg>
        <span id="viewsLabel">Views: —</span>
      </div>
    </div>

    <div class="info-row">
      <a class="contact-link" href="mailto:masonnet@masonnet.org">Contact Us</a>
    </div>
  </div>

  <!-- Button island with icons replacing labels -->
  <nav class="button-island" role="navigation" aria-label="Primary navigation">
    <button class="btn" aria-label="Home" title="Home">
      <!-- home icon -->
      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M3 11.5L12 4l9 7.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V11.5z" fill="currentColor"/>
      </svg>
    </button>

    <button class="btn" aria-label="Games" title="Games">
      <!-- gamepad icon -->
      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M6 10a4 4 0 0 0-4 4v1a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-1a4 4 0 0 0-4-4H6z" fill="currentColor"/>
        <circle cx="8" cy="13.5" r="0.9" fill="#00000000"/>
      </svg>
    </button>

    <button class="btn" aria-label="Projects" title="Projects">
      <!-- folder icon -->
      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M3 7a2 2 0 0 1 2-2h4l2 2h6a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7z" fill="currentColor"/>
      </svg>
    </button>

    <button class="btn" aria-label="More" title="More">
      <!-- dots / more icon -->
      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <circle cx="5" cy="12" r="1.6" fill="currentColor"/>
        <circle cx="12" cy="12" r="1.6" fill="currentColor"/>
        <circle cx="19" cy="12" r="1.6" fill="currentColor"/>
      </svg>
    </button>

    <button class="info-btn" id="infoBtn" aria-label="Info" aria-expanded="false" title="Info">
      <!-- info icon -->
      <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="1.4" fill="none"/>
        <rect x="11.4" y="10.2" width="1.2" height="5.5" rx="0.6" fill="currentColor"/>
        <rect x="11.4" y="7.2" width="1.2" height="1.2" rx="0.6" fill="currentColor"/>
      </svg>
    </button>
  </nav>

  <script>
    (function(){
      // --- view counter with "recent visit" suppression (1 hour) using CountAPI where possible ---
      const viewsLabel = document.getElementById('viewsLabel');
      const localVisitKey = 'masonnet_org_lastvisit';
      const storedCountKey = 'masonnet_org_localcount';
      const countNamespace = 'masonnet_org';
      const countKey = 'site_views';
      const hitUrl = `https://api.countapi.xyz/hit/${encodeURIComponent(countNamespace)}/${encodeURIComponent(countKey)}`;
      const getUrl = `https://api.countapi.xyz/get/${encodeURIComponent(countNamespace)}/${encodeURIComponent(countKey)}`;
      const threshold = Number(getComputedStyle(document.documentElement).getPropertyValue('--view-threshold-ms')) || 3600000;

      function setViews(v){
        viewsLabel.textContent = 'Views: ' + (typeof v === 'number' ? v.toLocaleString() : String(v));
      }

      function safeSetLocal(k,v){ try { localStorage.setItem(k,String(v)); } catch(e){} }
      function safeGetLocal(k){ try { return localStorage.getItem(k); } catch(e){ return null } }

      const lastVisit = parseInt(safeGetLocal(localVisitKey) || '0',10);
      const now = Date.now();
      const withinThreshold = !isNaN(lastVisit) && (now - lastVisit) < threshold;

      if (withinThreshold) {
        // fetch current value without incrementing
        fetch(getUrl, {cache:'no-store'}).then(r=>r.ok? r.json():Promise.reject(r)).then(data=>{
          if (data && typeof data.value==='number'){ setViews(data.value); safeSetLocal(storedCountKey,data.value) }
          else { const v=parseInt(safeGetLocal(storedCountKey)||'0',10); setViews(isNaN(v)?'—':v) }
        }).catch(()=>{ const v=parseInt(safeGetLocal(storedCountKey)||'0',10); setViews(isNaN(v)?'—':v) })
      } else {
        // increment global counter
        fetch(hitUrl, {method:'GET',cache:'no-store'}).then(r=>r.ok? r.json():Promise.reject(r)).then(data=>{
          if (data && typeof data.value==='number'){ setViews(data.value); safeSetLocal(storedCountKey,data.value); safeSetLocal(localVisitKey, now) }
          else { throw new Error('invalid') }
        }).catch(()=> {
          // fallback: try get, else local increment
          fetch(getUrl,{cache:'no-store'}).then(r=>r.ok?r.json():Promise.reject(r)).then(data=>{
            if (data && typeof data.value==='number'){ setViews(data.value); safeSetLocal(storedCountKey,data.value); safeSetLocal(localVisitKey, now) }
            else { throw new Error('invalidget') }
          }).catch(()=> {
            try {
              let v = parseInt(safeGetLocal(storedCountKey)||'0',10);
              v = isNaN(v)?1:v+1;
              safeSetLocal(storedCountKey,v); safeSetLocal(localVisitKey, now); setViews(v);
            } catch(e){ setViews('—') }
          })
        })
      }

      // --- info panel toggle and accessibility ---
      const infoBtn = document.getElementById('infoBtn');
      const infoPanel = document.getElementById('infoPanel');
      let lastFocused = null;
      function togglePanel(force){
        const show = typeof force === 'boolean' ? force : !infoPanel.classList.contains('visible');
        if (show){
          lastFocused = document.activeElement;
          infoPanel.classList.add('visible');
          infoPanel.setAttribute('aria-hidden','false');
          infoBtn.setAttribute('aria-expanded','true');
          try{ infoPanel.focus({preventScroll:true}); }catch(e){}
        } else {
          infoPanel.classList.remove('visible');
          infoPanel.setAttribute('aria-hidden','true');
          infoBtn.setAttribute('aria-expanded','false');
          try{ if(lastFocused) lastFocused.focus(); }catch(e){}
        }
      }

      infoBtn.addEventListener('click', ()=> togglePanel());
      infoBtn.addEventListener('keydown', (e)=> { if(e.key==='Enter' || e.key===' ') { e.preventDefault(); togglePanel(); } });

      document.addEventListener('click', (e)=> {
        if(!infoPanel.classList.contains('visible')) return;
        if(infoPanel.contains(e.target) || infoBtn.contains(e.target)) return;
        togglePanel(false);
      }, {capture:true});

      document.addEventListener('keydown', (e)=> { if(e.key === 'Escape') togglePanel(false); });

      // keep panel width within viewport
      function adjustPanel(){ if(infoPanel.offsetWidth > window.innerWidth - 32) infoPanel.style.width = (window.innerWidth - 32) + 'px'; else infoPanel.style.width = '' }
      window.addEventListener('resize', adjustPanel);
      adjustPanel();
    })();
  </script>
</body>
</html>
